<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Paiement - Elysian Unity</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="payment.css">
    <link rel="icon" type="image/png" href="/public/favicon.png">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">ELYSIAN UNITY</div>
            <nav>
                <a class="link" href="/index.html">← Retour</a>
            </nav>
        </header>

        <div class="grid">
            <main>
                <div class="card">
                    <h1>Paiement</h1>
                    <p class="lead">
                        Complète tes informations de livraison. Le paiement est sécurisé via Stripe.
                    </p>

                    <form id="paymentForm" novalidate>
                        <div class="field">
                            <label for="fullName">Nom complet</label>
                            <input id="fullName" name="fullName" type="text" placeholder="Prénom Nom" required>
                            <div class="error-text" id="err-fullName" style="display:none"></div>
                        </div>

                        <div class="row">
                            <div class="col field">
                                <label for="email">Email</label>
                                <input id="email" name="email" type="email" placeholder="exemple@mail.com" required>
                                <div class="error-text" id="err-email" style="display:none"></div>
                            </div>
                            <div class="col field">
                                <label for="phone">Téléphone</label>
                                <input id="phone" name="phone" type="text" placeholder="06 12 34 56 78">
                            </div>
                        </div>

                        <div class="field">
                            <label for="address">Adresse de livraison</label>
                            <textarea id="address" name="address" rows="3" placeholder="Adresse, code postal, ville" required></textarea>
                            <div class="error-text" id="err-address" style="display:none"></div>
                        </div>

                        <!-- <hr class="divider">
                        Les détails produit proviennent du panier (localStorage).
                        <p class="muted small">Les détails de produit (nom, tailles, quantités) sont prélevés depuis votre panier. Si le panier est vide, sélectionnez un produit ci-dessous.</p>
                        <hr class="divider"> -->

                        <h3 class="section-title">Informations de carte</h3>
                        <p class="muted small">
                            Le paiement est géré par Stripe. Tes informations bancaires ne sont jamais stockées par Elysian Unity.
                        </p>

                        <!-- Stripe Elements -->
                        <div class="field">
                            <label>Carte bancaire</label>
                            <div id="card-element" class="card-element">
                                <!-- Stripe Elements va être injecté ici -->
                            </div>
                            <div class="error-text" id="card-errors" role="alert" style="margin-top:0.35rem;"></div>
                        </div>

                        <div class="actions">
                            <button type="submit" id="payBtn" class="btn">PAYER</button>
                            <button type="button" id="clearBtn" class="btn secondary">EFFACER</button>
                        </div>

                        <p class="note">
                            En cliquant sur « PAYER », tu confirmes ta commande et ton paiement sécurisé.
                        </p>
                    </form>
                </div>
            </main>

            <aside>
                <div class="card">
                    <h3>Récapitulatif</h3>
                    <div class="summary" id="summaryBox">
                        <div id="summaryItems">
                            <!-- Liste des lignes du panier: injectée par JS -->
                        </div>
                        <div style="margin:0.6rem 0 1rem;">
                            <a href="/cart/cart.html" target="_blank" rel="noopener" class="btn-secondary" id="editCartBtn">Modifier le panier</a>
                        </div>

                        <div class="summary-row">
                            <div class="muted">Sous-total</div>
                            <div id="subTotal">45€</div>
                        </div>
                        <div class="summary-row">
                            <div class="muted">Livraison</div>
                            <div id="shipping">4€</div>
                        </div>
                        <div class="summary-row total-row">
                            <div>Total</div>
                            <div id="total">49€</div>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- Overlay de succès -->
    <div class="overlay" id="overlay">
        <div class="modal">
            <h2>Merci !</h2>
            <p class="muted" id="orderSummary">Votre commande a bien été payée.</p>
            <div class="modal-actions">
                <a id="backToHome" class="btn" href="./index.html">Retour à l'accueil</a>
            </div>
        </div>
    </div>

    <!-- Stripe + JS -->
    <script src="https://js.stripe.com/v3/"></script>
    <!-- Cart utilities (localStorage) -->
    <script src="/cart/cart.js"></script>
    <script src="/payment/payment.js"></script>
</body>
</html>
